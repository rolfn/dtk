# Rolf Niepraschk, 2015/07/14, Rolf.Niepraschk@gmx.de
#
# Hilfsdefinitionen zum make-Prozess für "Die TeXnische Komödie"
#
# -- unveränderlich --

LATEX = lualatex
LATEX = pdflatex
LATEX_OPTS = "--shell-escape"

MAKEINDEXSTYLE = dtk-idx.ist
MAKEGLOSSARYSTYLE = dtk-adr.ist

IDX_STYLE = dtk.xdy
MAKEINDEX = xindy -v -C utf8 -M $(IDX_STYLE) -L general -I latex

$(MAIN).pdf : $(MAIN).tex $(ARTICLES)
	$(LATEX) $(LATEX_OPTS) $<
	biber $(basename $<)
	$(MAKEINDEX) $(basename $<)-addresses.idx -o $(basename $<)-addresses.ind
	$(LATEX) $(LATEX_OPTS) $<

record : userpackages.tex

userpackages.tex : $(MAIN)0.tex $(ARTICLES)
	pdflatex -draftmode -interaction=nonstopmode $<

clean :
	$(RM) $(addprefix $(MAIN), .log .aux .blg .toc .bbl .bcf .idx .ind .run.xml)

veryclean : clean
	$(RM) $(addprefix $(MAIN), .pdf) userpackages.tex
